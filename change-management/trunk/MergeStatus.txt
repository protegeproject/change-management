Copied from trunk revision 8821
Merged to trunk 9887
